<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.340">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kay Kozaronek">
<meta name="dcterms.date" content="2023-08-22">
<meta name="description" content="Wanna become a master at Integration by Parts? Let me show you my favorite entry from The Summer of Math Exposition by 3Blue1Brown">

<title>Unashamed Curiosity - Integration by Parts for Archers</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Unashamed Curiosity</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Posts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../now.html" rel="" target="">
 <span class="menu-text">What I’m Doing Now</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../collaborators.html" rel="" target="">
 <span class="menu-text">Collaborators</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Integration by Parts for Archers</h1>
                  <div>
        <div class="description">
          Wanna become a master at Integration by Parts? Let me show you my favorite entry from The Summer of Math Exposition by 3Blue1Brown
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Integration by Parts</div>
                <div class="quarto-category">Calculus</div>
                <div class="quarto-category">Mathematics</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Kay Kozaronek </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">August 22, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>
</p><center>
<img src="media/archer.png" width="100%" height="30%">
</center>
<p></p>
<section id="the-summer-of-math-exposition" class="level1">
<h1>The Summer of Math Exposition</h1>
<p>I recently took part in <a href="https://some.3b1b.co/">The Summer of Math Exposition by 3Blue1Brown</a>. It is an annual competition to foster the creation of excellent math content online. Not only did I have to produce my own math explainer, but I also got a chance to grade other people’s work.</p>
<p>Here’s the approach I used to grade other entries:</p>
<table class="table">
<colgroup>
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 73%">
</colgroup>
<thead>
<tr class="header">
<th>Criteria</th>
<th>Score Range</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Motivation</td>
<td>0/10</td>
<td>Why should anyone care about this topic?</td>
</tr>
<tr class="even">
<td>Explanation</td>
<td>0/10</td>
<td>How well was the tale told? How transparent was the reasoning?</td>
</tr>
<tr class="odd">
<td>Originality</td>
<td>0/10</td>
<td>Was the story a fresh breath of mathematical air?</td>
</tr>
<tr class="even">
<td>Length</td>
<td>0/5</td>
<td>Was the duration of the story appropriate? Was it engaging all the way?</td>
</tr>
<tr class="odd">
<td>Overall</td>
<td>0/35</td>
<td>The grand total.</td>
</tr>
</tbody>
</table>
<p>My overall favorite was a video about integration by parts. Don’t worry if your calculus is a little rusty. Here’s a refresher of the standard method.</p>
</section>
<section id="integration-by-parts-for-calculus-students" class="level1">
<h1>Integration by Parts for Calculus Students</h1>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip: Don’t look at the Math Alert, it might bore you.
</div>
</div>
<div class="callout-body-container callout-body">
<p>In case you’re tired of regular Integration by Parts skip to the next section on <strong>Integration by Parts for Archers</strong></p>
</div>
</div>
<p>Let’s suppose you’re staring at the following integral <span class="math inline">\(\int x \cos(x) \, dx\)</span>. How would you solve this?</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Math Alert - I warned you.
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>To solve this, we can use integration by parts. The formula for integration by parts is:</p>
<p><span class="math display">\[\int u \, dv = uv - \int v \, du\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(u\)</span> is the function we choose to differentiate</li>
<li><span class="math inline">\(dv\)</span> is the function we choose to integrate</li>
</ul>
<p>Our goal is to choose <span class="math inline">\(u\)</span> and <span class="math inline">\(dv\)</span> such that their derivatives <span class="math inline">\(du\)</span> and integrals <span class="math inline">\(v\)</span>, respectively, simplify the problem.</p>
<p>Let’s choose:</p>
<p><span class="math display">\[u = x \implies du = dx\]</span> <span class="math display">\[dv = \cos(x) \, dx \implies v = \int \cos(x) \, dx\]</span></p>
<p>Now, we’ll determine <span class="math inline">\(du\)</span> and <span class="math inline">\(v\)</span>:</p>
<p><span class="math display">\[du = dx\]</span> <span class="math display">\[v = \int \cos(x) \, dx = \sin(x)\]</span></p>
<p>Now, plug these values into the integration by parts formula:</p>
<p><span class="math display">\[\int x \cos(x) \, dx = x \sin(x) - \int \sin(x) \, dx\]</span></p>
<p>To finish solving the integral, we just need to integrate <span class="math inline">\(\sin(x)\)</span>. Let’s do that:</p>
<p>The integral of <span class="math inline">\(\sin(x)\)</span> with respect to <span class="math inline">\(x\)</span> is <span class="math inline">\(-\cos(x)\)</span>.</p>
<p>Now, plugging this into our equation, we get:</p>
<p><span class="math display">\[\int x \cos(x) \, dx = x \sin(x) + \cos(x) + C\]</span></p>
<p>Where <span class="math inline">\(C\)</span> is the constant of integration.</p>
<p>So, the integral of <span class="math inline">\(x \cos(x)\)</span> is:</p>
<p><span class="math display">\[x \sin(x) + \cos(x) + C\]</span></p>
</div>
</div>
</div>
<p>Visually it looks like this: <video src="media/video.mp4" class="img-fluid" controls=""><a href="media/video.mp4">Video</a></video></p>
</section>
<section id="integration-by-parts-for-archers" class="level1">
<h1>Integration by Parts for Archers</h1>
<p>Now, wasn’t that tedious? Here’s the new, improved method:</p>
<blockquote class="blockquote">
<p>Arrow Marked Integral = Top Product - Outer Integral.</p>
</blockquote>
<p>What do all of these mean? I’ll let the author of the video explain it to you. Hopefully, you’ll find it as insightful as I did.</p>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/bHu3CfJ3ttk" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<p><strong>My rating:</strong></p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 86%">
</colgroup>
<thead>
<tr class="header">
<th>Criteria</th>
<th>Score</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Motivation</td>
<td>10/10</td>
<td>This video was extremely well-motivated. Thanks for solving the integration by parts pain!</td>
</tr>
<tr class="even">
<td>Explanation</td>
<td>10/10</td>
<td>The explanation was so clear and engaging that I stopped the video at some points and tried the method myself</td>
</tr>
<tr class="odd">
<td>Originality</td>
<td>10/10</td>
<td>You literally just developed a new approach to doing integration by parts. This is awesome.</td>
</tr>
<tr class="even">
<td>Length</td>
<td>5/5</td>
<td>The length was appropriate. I always felt stimulated and engaged.</td>
</tr>
<tr class="odd">
<td>Overall</td>
<td>35/35</td>
<td>Best video I’ve seen so far at the competition. I also like that you paid attention to the audio quality. Lots of people neglected this.</td>
</tr>
</tbody>
</table>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
“Zero Knowledge Proofs - My second favorite video.
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This video was a close contender for my overall favorite video but it covered a topic I have not encountered before and was too information dense in the second half of the video.</p>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/FfeXX6OLq8w" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<p><strong>My rating:</strong></p>
<table class="table">
<colgroup>
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 92%">
</colgroup>
<thead>
<tr class="header">
<th>Criteria</th>
<th>Score</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Motivation</td>
<td>10/10</td>
<td>The video was very well-motivated. I particularly liked the visually easy-to-follow sudoku example.</td>
</tr>
<tr class="even">
<td>Explanation</td>
<td>8.5/10</td>
<td>The video was very well explained until 15:42 when you started talking about polynomial commitments. The screen was very often overwhelmingly full of information and I couldn’t follow the content very well.</td>
</tr>
<tr class="odd">
<td>Originality</td>
<td>6.5/10</td>
<td>As part of the competition I’ve seen other Zero Knowledge Proof videos, but this one was by far the most thorough. The visualizations were well made and the guiding sudoku example was well chosen. I think this was not the most original work I’ve seen as the topic could have been covered by lots of other people. The way in which it was covered was sufficiently distinct though.</td>
</tr>
<tr class="even">
<td>Length</td>
<td>3/5</td>
<td>For my taste the video was too long. The video should have been split in 2. Part 1 (0:00 - 15:42) and Part 2 (15:42 - 26:48). Part 1 was very well explained and I was fully engaged. My attention started drifting in Part 2 as I couldn’t follow the main concepts.</td>
</tr>
<tr class="odd">
<td>Overall</td>
<td>28/35</td>
<td>The second-best video I’ve seen so far. Good job!</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<section id="polysemanticity-and-capacity-in-neural-networks" class="level2">
<h2 class="anchored" data-anchor-id="polysemanticity-and-capacity-in-neural-networks">Polysemanticity and Capacity in Neural Networks</h2>
<p>Last but not least, here’s my own entry. It’s a walkthrough of the key concepts necessary to understand the paper <a href="https://arxiv.org/pdf/2210.01892.pdf">“Polysemanticity and Capacity in Neural Networks”</a>.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Jargon Alert
</div>
</div>
<div class="callout-body-container callout-body">
<p>This is a video about ongoing research in AI Safety. You might not have the necessary background to understand everything.</p>
<p>That’s ok, I tried to introduce all relevant terms and abstract away the math with visual intuitions.</p>
</div>
</div>
<p>From the papers abstract:</p>
<blockquote class="blockquote">
<p>Individual neurons in neural networks often represent a mixture of unrelated features. This phenomenon, called polysemanticity, can make interpreting neural networks more difficult and so we aim to understand its causes. We propose doing so through the lens of feature capacity, which is the fractional dimension each feature consumes in the embedding space.</p>
</blockquote>
<p>In the video, I explain:</p>
<ul>
<li>Polysemiticity and how it’s different from superposition</li>
<li>The impact of feature importance and sparsity on representation capacity allocation</li>
<li>Visualizations of polysemantic and monosemantic neurons</li>
<li>Feature capacity and its relation to fractional dimension</li>
<li>Budget allocation plots and their analysis</li>
<li>Phase diagrams for understanding feature allocation dynamics</li>
</ul>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/ovmRuyqbxXU" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<p>What’s your rating? I’d love to hear some feedback.</p>
</section>
<section id="conclusion-and-call-to-action" class="level2">
<h2 class="anchored" data-anchor-id="conclusion-and-call-to-action">Conclusion and Call to Action</h2>
<p>What a summer it’s been! From delving deep into mathematical wonders to appreciating the art of explaining complex topics, it’s been a whirlwind of learning and fun. And if there’s one thing I’ve taken away from this adventure, it’s the sheer joy of creating math explainers. So, dear reader, I urge you to dive into the world of math exposition. Craft your own stories. Share your passion. Who knows? Maybe next summer, I’ll be watching your video and getting my mind blown!</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>